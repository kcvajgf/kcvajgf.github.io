Use Linux.


# Using the same computer for the leaderboard account and display

1. Run `pc2board` on the `scoreboard_icpc/` folder. This tells PC^2 to generate the score HTML files under `scoreboard_icpc/html/`. You may need to place the (correctly configured) `pc2v9.ini` file in `scoreboard_icpc/` for it to run there. For example,
    
    ```bash
    cd path/to/scoreboard_icpc/
    cp path/to/pc2-9.6.0/pc2v9.ini .
    path/to/pc2-9.6.0/bin/pc2board
    ```

2. On a different terminal, use `nocache_serve` (a Python 3 script) to serve `scoreboard_icpc/`.  

    ```bash
    cd path/to/scoreboard_icpc/
    ./nocache_serve
    ```

3. Open `http://localhost:8000` in a browser. It should now work.

*Notes:*

- You may need to make `nocache_serve` executable via `chmod`. (Alternatively, just use `python3 nocache_serve` or something.)

- You can specify a different port by passing it to `nocache_serve`, like `./nocache_serve 8080`.  


# Using different computers for the leaderboard account and display

Assume for example that the IP address of the PC^2 leaderboard account computer is 192.168.1.11. Then:

1. On the leaderboard account computer, log in with a scoreboard account (anywhere), then use `cors_serve` to serve the `html/` folder generated by PC^2.

    ```bash
    cd path/to/pc2-generated/html
    path/to/cors_serve
    ```

2. On the leaderboard display computer, open `file:///path/to/scoreboard_icpc/index.html?src=http://192.168.1.11:8000` in a browser.

*Notes:*

- You may need to make `cors_serve` executable via `chmod`. (Alternatively, just use `python3 path/to/cors_serve` or something.)

- You can specify a different port by passing it to `cors_serve`, like `path/to/cors_serve 8080`.  

- On the leaderboard display computer, you can also choose to serve the `scoreboard_icpc/` folder. Then in the browser, we will just open `http://localhost.8000/?src=http://192.168.1.11:8000`.  


# Serving to the general public

For this, you will need a server with a public IP address, and another computer that has access to a `pc2board` account and can access the server via SSH.  

1. On the server, use `nocache_serve` to serve `scoreboard_icpc/`.  

2. On the other computer, log in with a scoreboard account (anywhere), then set up a script that copies the `html/index.html` file generated by PC^2 to the server's `scoreboard_icpc/html/` folder every 15 seconds or so, perhaps using `scp`, for example with a script like this:

    ```bash
    while true; do
        echo "Copying now..."
        scp local/path/to/html/index.html xxx@xx.xx.xx.xx:~/path/in/server/to/scoreboard_icpc/html/ && echo "successful" || echo "failed :( trying again later"
        sleep 15
    done
    ```

    where `xxx@xx.xx.xx.xx` is the public server.


*Notes:*  

- One way of doing this would be to set up a temporary SSH key for the scoreboard computer so you don't need to specify the plain password in the script. You can just delete the key afterward.


# Behind the hood

The thing works by reading off the `html/index.html` file produced by PC^2. Most of the setting up is just pointing it to where it can get this file.

In essence, it receives a URL param called `src` which should be a valid URL. It then fetches `/index.html` from that URL every 5 seconds or so. If the URL is not on the same domain as the one running `scoreboard_icpc/index.html`, then it needs to allow CORS (cross-origin resource sharing), otherwise, it will refuse the GET request and the scoreboard cannot read the data.

If `src` is not passed, then it defaults to `html/` (relative to the folder `scoreboard_icpc/`). As long as you can serve the files statically here and are able to update `html/index.html` constantly (say by copying it over every few seconds, perhaps via `scp`), the `src` param will not be needed.  

*Side comment:* since the `html/index.html` file is constantly changing, I think the term "static files" is not quite accurate. Oh well, I hope you get the point.


## Security and stability  

`nocache_serve` and `cors_serve` both use Python's `http.server` library to serve the files. There are some pretty scary security warnings in its [doc](https://docs.python.org/3/library/http.server.html). I don't know how bad this really is, especially for something as simple as serving a few html, js and css files, but if you're that concerned about stability and security (maybe you have a huge audience, or your server is sensitive), then I suggest finding alternatives to `nocache_serve` and `cors_serve`. It only needs to serve a bunch of "static" files, with no-cache (otherwise, the leaderboard won't update since it will fetch a cached version every time), and in the case of `cors_serve`, it needs CORS.
